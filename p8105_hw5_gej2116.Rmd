---
title: "Homework 5"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(dplyr)
library(viridis)
library(p8105.datasets)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

Did not include as it isn't graded.

## Problem 2

### Import CSV

```{r import_data}
hom_df =
  read_csv("./data/homicide-data.csv")
```

### Raw Data Description

```{r skim, echo=T, results='hide'}
skimr::skim(hom_df)
```

The homicide data contains `r nrow(hom_df)` observations and `r ncol(hom_df)` variables. For each reported case of homicide, the dataset provides victim's name, race, age, sex, location (city, state, latitude, and longitude), and disposition.

### Number of Homicides and Unsolved Cases in Each City, State

```{r org_data}
hom_df = hom_df %>% 
  mutate(city_state = str_c(city, state, sep = ", "))

n_homicide = hom_df %>% 
  group_by(city_state) %>% 
  summarize(n_homicide = n())

n_unsolved = hom_df %>% 
  filter(disposition %in% c("Closed without arrest", "Open/No arrest")) %>% 
  group_by(city_state) %>% 
  summarize(n_unsolved = n())

summ = left_join(n_homicide, n_unsolved, by = "city_state") 
knitr::kable(summ)
```

### Baltimore, MD: Proportion of Unsolved Homicide Cases

```{r MD_unsolved}
MD_unsolved = summ %>% 
  filter(city_state == "Baltimore, MD")

MD_prop = prop.test(MD_unsolved %>%  pull(n_unsolved), MD_unsolved %>% pull(n_homicide)) %>% 
  broom::tidy()

MD_prop
```

64.6% (95% CI: 62.8%, 66.3%) of reported homicides in Baltimore, MD are unsolved cases.

